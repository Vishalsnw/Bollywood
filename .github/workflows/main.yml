name: Bollywood App Enhancements

on:
  push:
    branches:
      - main

jobs:
  enhance-ui:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: Install dependencies
        run: yarn install

      - name: Add Sidebar if not exists
        run: |
          mkdir -p src/components
          if [ ! -f src/components/Sidebar.js ]; then
            echo "import React from 'react';\nimport { Link } from 'react-router-dom';\n\nconst Sidebar = () => {\n  return (\n    <aside style={{ width: '200px', padding: '20px', background: '#eee' }}>\n      <h3>Menu</h3>\n      <ul>\n        <li><Link to='/nominations'>Oscar Nominations</Link></li>\n        <li><Link to='/winners'>Oscar Winners</Link></li>\n        <li><Link to='/producers'>Producers</Link></li>\n      </ul>\n    </aside>\n  );\n};\n\nexport default Sidebar;" > src/components/Sidebar.js
          fi

      - name: Add WinnerReveal if not exists
        run: |
          mkdir -p src/features/oscars
          if [ ! -f src/features/oscars/WinnerReveal.js ]; then
            echo "import React, { useState } from 'react';\nimport { Fade } from '@mui/material';\n\nconst WinnerReveal = ({ winner }) => {\n  const [show, setShow] = useState(false);\n\n  return (\n    <div style={{ marginTop: '20px' }}>\n      <button onClick={() => setShow(true)}>Reveal Winner</button>\n      <Fade in={show}>\n        <div><h2 style={{ color: 'green' }}>{winner}</h2></div>\n      </Fade>\n    </div>\n  );\n};\n\nexport default WinnerReveal;" > src/features/oscars/WinnerReveal.js
          fi

      - name: Add ProducerList if not exists
        run: |
          mkdir -p src/features/producers
          if [ ! -f src/features/producers/ProducerList.js ]; then
            echo "import React from 'react';\n\nconst ProducerList = ({ producers }) => {\n  const sorted = [...producers].sort((a, b) => b.wealth - a.wealth);\n\n  return (\n    <ul>\n      {sorted.map((p, index) => (\n        <li key={p.name}>\n          #{index + 1} {p.name} - â‚¹{p.wealth} Cr\n          {p.rankChange > 0 ? ' ðŸ”¼' : p.rankChange < 0 ? ' ðŸ”½' : ''}\n        </li>\n      ))}\n    </ul>\n  );\n};\n\nexport default ProducerList;" > src/features/producers/ProducerList.js
          fi

      - name: Add NewsFeed if not exists
        run: |
          mkdir -p src/features/news
          if [ ! -f src/features/news/NewsFeed.js ]; then
            echo "import React from 'react';\nimport { Slide } from '@mui/material';\n\nconst NewsFeed = ({ news }) => {\n  return (\n    <div>\n      <h2>Breaking News</h2>\n      {news.map((item, idx) => (\n        <Slide direction='up' in={true} mountOnEnter unmountOnExit key={idx}>\n          <div style={{ background: '#fff3e0', padding: '10px', margin: '10px 0' }}>\n            ðŸ“° {item.headline}\n            {item.type === 'loan' && <span> ðŸ’¸ Took a loan</span>}\n            {item.type === 'bankrupt' && <span> ðŸš¨ Bankrupt!</span>}\n          </div>\n        </Slide>\n      ))}\n    </div>\n  );\n};\n\nexport default NewsFeed;" > src/features/news/NewsFeed.js
          fi

      - name: Install peer UI dependencies
        run: yarn add react-router-dom @mui/material @emotion/react @emotion/styled

      - name: Build App
        run: yarn run build
        
