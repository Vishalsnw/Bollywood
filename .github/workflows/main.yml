name: React App Inspector

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  inspect-app:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v3

      - name: âš™ï¸ Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'

      - name: ğŸ“¦ Install dependencies
        run: |
          yarn install --frozen-lockfile || yarn install

      - name: ğŸ” Lint and detect file errors
        run: |
          echo "Running ESLint check..."
          yarn add eslint@8 --dev
          npx eslint src/ || echo "âš ï¸ ESLint completed with warnings or errors"

      - name: ğŸ“ Check if critical files exist
        run: |
          echo "ğŸ” Checking required files..."
          FILES=(
            "src/components/GameScreen.js"
            "src/components/Sidebar.js"
            "src/features/producers/ProducersPage.js"
            "src/features/news/NewsPage.js"
            "src/features/oscars/OscarWinnersPage.js"
            "src/features/studios/StudioPage.js"
            "src/features/actors/ActorsPage.js"
            "src/features/market/MarketPage.js"
            "src/context/GameContext.js"
            "src/store.js"
          )

          for file in "${FILES[@]}"; do
            if [[ ! -f "$file" ]]; then
              echo "âŒ Missing: $file"
              exit 1
            else
              echo "âœ… Found: $file"
            fi
          done

      - name: ğŸ— Try Build
        run: |
          echo "ğŸ›  Trying to build project..."
          yarn build || echo "âŒ Build failed â€” check above logs"
